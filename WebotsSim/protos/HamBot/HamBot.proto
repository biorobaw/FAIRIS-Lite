#VRML_SIM R2025a utf8

PROTO HamBot [
  field SFVec3f     translation     0 0 0
  field SFRotation  rotation        0 0 1 1.57
  field SFString    name            "HamBot"
  field SFString    controller      "Template"
  field MFString    controllerArgs  []
  field SFString    customData      ""
  field SFBool      supervisor      TRUE
  field SFBool      synchronization TRUE
  field SFBool      selfCollision   FALSE
]
{
  Robot {
    translation IS translation
    rotation IS rotation
    name IS name
    controller IS controller
    controllerArgs IS controllerArgs
    customData IS customData
    supervisor IS supervisor
    synchronization IS synchronization
    selfCollision IS selfCollision
    children [

      # HamBot Meshes
      Pose {
        translation 0 0 0.04
        rotation 0 0 1 1.57
        children [
          Shape {
            appearance PBRAppearance {
              baseColor 0.0 0.5 0.2
              roughness 0.6
              metalness 0.1
            }
            geometry Mesh {
              url ["models/HamBot/PlasticsGreen.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.8 0.8 0.8
              roughness 0.3
              metalness 0.9
            }
            geometry Mesh {
              url ["models/HamBot/MetalSilver.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.8 0.8 0.8
              roughness 0.3
              metalness 0.9
            }
            geometry Mesh {
              url ["models/HamBot/MetalSilverShadow.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 1.0 0.843 0.0
              roughness 0.4
              metalness 1.0
            }
            geometry Mesh {
              url ["models/HamBot/MetalGold.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 1.0 0.843 0.0
              roughness 0.4
              metalness 1.0
            }
            geometry Mesh {
              url ["models/HamBot/MetalGold.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.1 0.1 0.1
              roughness 0.6
              metalness 0.2
            }
            geometry Mesh {
              url ["models/HamBot/GlossyBlack.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.1 0.1 0.1
              roughness 0.6
              metalness 0.2
            }
            geometry Mesh {
              url ["models/HamBot/LidarShell1.obj"]
            }
            castShadows FALSE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.1 0.1 0.1
              roughness 0.6
              metalness 0.2
            }
            geometry Mesh {
              url ["models/HamBot/LidarShell2.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.1 0.1 0.1
              roughness 0.6
              metalness 0.0
            }
            geometry Mesh {
              url ["models/HamBot/PlasticBlackShadow.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.9 0.9 0.9
              roughness 0.3
              metalness 0.0
            }
            geometry Mesh {
              url ["models/HamBot/PlasticWhite.obj"]
            }
            castShadows FALSE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 1.0 0.0 0.0
              roughness 0.5
              metalness 0.1
            }
            geometry Mesh {
              url ["models/HamBot/Glossy Red.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.0 0.5 0.0
              roughness 0.4
              metalness 0.0
            }
            geometry Mesh {
              url ["models/HamBot/PCB.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.05 0.05 0.05
              roughness 0.8
              metalness 0.1
            }
            geometry Mesh {
              url ["models/HamBot/PlasticsBlack.obj"]
            }
            castShadows TRUE
          }
          Shape {
            appearance PBRAppearance {
              baseColor 0.05 0.05 0.05
              roughness 0.7
            }
            geometry Mesh {
              url ["models/HamBot/Rubber.obj"]
            }
            castShadows TRUE
          }
        ]
      }

      # Left Wheel
      HingeJoint {
        jointParameters HingeJointParameters {
          axis 0 1 0
          anchor 0.0 0.0 0.012
          dampingConstant 5.0
          staticFriction 1.0
        }
        device [
          RotationalMotor {
            name "left motor"
            maxVelocity 20
            maxTorque 110
          }
          PositionSensor {
            name "left wheel encoder"
          }
        ]
        endPoint Solid {
          translation 0.0 0.0 0.0
          rotation 0 0 1 0
          children [
            Pose {
              translation 0 0.0865 0.012
              rotation 0 0 1 -1.57
              children [
                Shape {
                  appearance PBRAppearance {
                    baseColor 0.05 0.05 0.05
                    roughness 0.7
                  }
                  geometry Mesh {
                    url [ "models/HamBot/Wheel.obj" ]
                  }
                }
              ]
            }
          ]
          name "left wheel"
          boundingObject Pose {
            translation 0 0.092 0.012
            rotation 1 0 0 1.57
            children [
              Cylinder {
                height 0.01
                radius 0.045
              }
            ]
          }
          physics Physics {
            density -1
            mass 0.0005
          }
        }
      }

      # Right Wheel
      HingeJoint {
        jointParameters HingeJointParameters {
          axis 0 1 0
          anchor 0.0 0.0 0.012
          dampingConstant 5.0
          staticFriction 1.0
        }
        device [
          RotationalMotor {
            name "right motor"
            maxVelocity 20
            maxTorque 110
          }
          PositionSensor {
            name "right wheel encoder"
          }
        ]
        endPoint Solid {
          translation 0 0 0
          rotation 1 0 0 0
          children [
            Pose {
              translation 0.0 -0.0911 0.012
              rotation 0 0 1 1.57
              children [
                Shape {
                  appearance PBRAppearance {
                    baseColor 0.05 0.05 0.05
                    roughness 0.7
                  }
                  geometry Mesh {
                    url [ "models/HamBot/Wheel.obj" ]
                  }
                }
              ]
            }
          ]
          name "right wheel"
          boundingObject Pose {
            translation 0.0 -0.092 0.012
            rotation 1 0 0 1.57
            children [
              Cylinder {
                height 0.01
                radius 0.045
              }
            ]
          }
          physics Physics {
            density -1
            mass 0.0005
          }
        }
      }

      InertialUnit {
        name "imu"
        translation 0 0 0
      }

      Camera {
        name "camera"
        translation  0.09 0.0 0.08
        rotation 0 0 1 0
        fieldOfView 0.7854
        width 224
        height 224
        recognitionColors [
          1 0 0,
          0 1 0,
          0 0 1,
          1 1 0
        ]
        recognition Recognition { }
      }

      Lidar {
        name "lidar"
        translation 0 0 0.13
        rotation 0 0 1 0
        fieldOfView 6.283184
        horizontalResolution 360
        numberOfLayers 1
        near 0.05
        minRange 0.05
        maxRange 12.0
        noise 0.000833
        resolution 0.01
        type "fixed"
      }

      GPS {
        name "gps"
      }

      Display {
        name "Place Cell Display"
        width 800
        height 800
      }

      Solid {
        name "caster_rear"
        translation -0.0835 -0.002 -0.021
        children [
          Shape {
            appearance PBRAppearance {
              baseColor 1 1 1
              roughness 0.6
              metalness 0.9
            }
            geometry DEF CASTER_SPHERE_REAR Sphere {
              radius 0.0109
              subdivision 4
            }
          }
        ]
        boundingObject USE CASTER_SPHERE_REAR
        physics Physics {
          damping Damping {
            linear 0.1
            angular 0.1
          }
        }
        contactMaterial "casterWheel"
      }

      Solid {
        name "caster_front"
        translation 0.0835 -0.002 -0.021
        children [
          Shape {
            appearance PBRAppearance {
              baseColor 1 1 1
              roughness 0.6
              metalness 0.9
            }
            geometry DEF CASTER_SPHERE_FRONT Sphere {
              radius 0.0109
              subdivision 4
            }
          }
        ]
        boundingObject USE CASTER_SPHERE_FRONT
        physics Physics {
          damping Damping {
            linear 0.1
            angular 0.1
          }
        }
        contactMaterial "casterWheel"
      }



    ]

    boundingObject Group {
      children [
        Pose {
          translation 0.0 0.0 0.06
          children [
            Box {
              size 0.19 0.15 0.171
            }
          ]
        }
      ]
    }

    physics Physics {
      density -1
      mass 0.226
    }
  }
}
